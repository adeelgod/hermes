<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <bean id="pdfFilter" class="org.apache.camel.component.file.AntPathMatcherGenericFileFilter">
        <property name="includes" value="*.pdf"/>
    </bean>

    <bean id="splitFileRepo" class="org.apache.camel.processor.idempotent.FileIdempotentRepository">
        <property name="fileStore">
            <bean class="java.io.File">
                <constructor-arg value="./.splitcache" />
            </bean>
        </property>
    </bean>

    <camelContext id="camel" xmlns="http://camel.apache.org/schema/spring">
        <route>
            <from uri="file://./inbox/?noop=true&amp;idempotentKey=${file:name}-${file:size}-${file:modified}}&amp;idempotentRepository=#splitFileRepo&amp;filter=#pdfFilter" />
            <to uri="bean:documentSplitProcessor"/>
        </route>

        <!--
        <route>
            <from uri="file://./extract/?delete=false&amp;idempotent=false&amp;filter=#pdfFilter" />
            <log logName="com.m11n.hermes" loggingLevel="DEBUG" message="########## META DATA PDF... ${file:name}" />
            <to uri="bean:documentMetaDataProcessor"/>
            <log logName="com.m11n.hermes" loggingLevel="DEBUG" message="########## META DATA PDF... type: ${headers.HERMES_DOCUMENT_TYPE} id: ${headers.HERMES_ORDER_ID}" />
            <to uri="file://./result/" />
        </route>
        -->
    </camelContext>

</beans>
